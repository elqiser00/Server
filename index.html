<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¬ Ø±ÙØ¹ Ø£ÙÙ„Ø§Ù… Ù…Ø¹ Ø¹Ø±Ø¶ Ø¬Ø§Ù†Ø¨ÙŠ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: #0d1b2a; color: white; min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: rgba(0,0,0,0.7); padding: 30px; border-radius: 20px; border: 3px solid #00b4d8; }
        header { text-align: center; margin-bottom: 30px; }
        header h1 { color: #ffd700; font-size: 2.5rem; margin-bottom: 10px; }
        .layout-preview { 
            display: flex; 
            margin: 20px 0; 
            background: rgba(255,255,255,0.1); 
            padding: 20px; 
            border-radius: 10px;
            gap: 10px;
        }
        .layout-preview img { 
            width: 40%; 
            background: #1b263b; 
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #4cc9f0;
        }
        .layout-preview video { 
            width: 60%; 
            background: #1b263b; 
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #ff4d6d;
        }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #ffd700; font-weight: bold; }
        input { width: 100%; padding: 15px; background: rgba(255,255,255,0.1); border: 2px solid #415a77; border-radius: 10px; color: white; }
        .btn { padding: 15px 30px; background: linear-gradient(135deg, #00b4d8, #0077b6); color: white; border: none; border-radius: 10px; font-size: 1.1rem; cursor: pointer; width: 100%; margin-top: 20px; }
        .btn:hover { background: linear-gradient(135deg, #0096c7, #005f8a); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .logs { background: rgba(0,0,0,0.5); border-radius: 10px; padding: 20px; max-height: 300px; overflow-y: auto; margin-top: 20px; font-family: monospace; }
        .success { color: #4caf50; }
        .error { color: #ff4d6d; }
        .info { color: #4cc9f0; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¬ Ø±ÙØ¹ Ø£ÙÙ„Ø§Ù… Ù…Ø¹ Ø¹Ø±Ø¶ Ø¬Ø§Ù†Ø¨ÙŠ</h1>
            <p>Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± | Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†</p>
        </header>
        
        <div class="layout-preview">
            <img src="https://via.placeholder.com/300x450/1b263b/ffffff?text=ğŸ“¸+Ø§Ù„ØµÙˆØ±Ø©" alt="Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±">
            <video controls poster="https://via.placeholder.com/480x360/1b263b/ffffff?text=ğŸ¥+Ø§Ù„ÙÙŠØ¯ÙŠÙˆ">
                <source src="#" type="video/mp4">
            </video>
        </div>
        
        <form id="uploadForm">
            <div class="form-group">
                <label for="channelLink">ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø©</label>
                <input type="text" id="channelLink" value="https://t.me/+VvLRMffUCXNlNjRk" required>
                <small style="color: #4cc9f0;">ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø© ÙƒØ§Ù…Ù„Ø§Ù‹</small>
            </div>
            
            <div class="form-group">
                <label for="movieName">ğŸ“ Ø§Ø³Ù… Ø§Ù„ÙÙŠÙ„Ù…</label>
                <input type="text" id="movieName" value="Truth & Treason 2025" required>
            </div>
            
            <div class="form-group">
                <label for="posterUrl">ğŸ–¼ï¸ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨ÙˆØ³ØªØ± (ØµÙˆØ±Ø©)</label>
                <input type="url" id="posterUrl" value="https://img.downet.net/uploads/U8xQf.webp" required>
                <small style="color: #4cc9f0;">Ø³ØªØ±ÙØ¹ Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±</small>
            </div>
            
            <div class="form-group">
                <label for="videoUrl">ğŸ¥ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (.mp4)</label>
                <input type="url" id="videoUrl" placeholder="https://example.com/video.mp4" required>
                <small style="color: #ff4d6d;">ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ Ù…Ø¨Ø§Ø´Ø± - Ø³ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†</small>
            </div>
            
            <button type="submit" class="btn" id="submitBtn">
                <i class="fas fa-film"></i> Ø±ÙØ¹ Ø§Ù„ÙÙŠÙ„Ù… Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
            </button>
        </form>
        
        <div class="logs" id="logContainer">
            <div class="info">ğŸš€ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±ÙØ¹ Ù…Ø¹ Ø¹Ø±Ø¶ Ø¬Ø§Ù†Ø¨ÙŠ</div>
            <div class="info">ğŸ“¸ Ø§Ù„ØµÙˆØ±Ø© â† | Ø§Ù„ÙÙŠØ¯ÙŠÙˆ â†’</div>
        </div>
    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        const GITHUB_TOKEN = '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'; // Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ø§ Ø¨Ù€ token Ø­Ù‚ÙŠÙ‚ÙŠ
        const REPO_OWNER = 'elqiser00';
        const REPO_NAME = 'Server';
        const WORKFLOW_ID = 'upload_movie.yml'; // Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù€ workflow
        
        function addLog(msg, type = 'info') {
            const container = document.getElementById('logContainer');
            const entry = document.createElement('div');
            entry.textContent = `â€¢ ${new Date().toLocaleTimeString()} - ${msg}`;
            entry.className = type;
            container.appendChild(entry);
            container.scrollTop = container.scrollHeight;
        }
        
        async function triggerGitHubAction(formData) {
            try {
                addLog('ğŸ”— Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ GitHub Action...', 'info');
                
                const response = await fetch(
                    `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/actions/workflows/${WORKFLOW_ID}/dispatches`,
                    {
                        method: 'POST',
                        headers: {
                            'Authorization': `token ${GITHUB_TOKEN}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            ref: 'main', // Ø§Ù„ÙØ±Ø¹
                            inputs: {
                                channel_link: formData.channel_link,
                                movie_name: formData.movie_name,
                                poster_url: formData.poster_url,
                                video_url: formData.video_url
                            }
                        })
                    }
                );
                
                if (response.ok) {
                    addLog('âœ… ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù€ Action Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    addLog('ğŸ“Š Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…...', 'info');
                    
                    // ÙØªØ­ ØµÙØ­Ø© Actions Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©
                    setTimeout(() => {
                        window.open(`https://github.com/${REPO_OWNER}/${REPO_NAME}/actions`, '_blank');
                        addLog('ğŸ” Ø§ÙØªØ­ ØµÙØ­Ø© Actions Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', 'info');
                    }, 2000);
                    
                    return true;
                } else {
                    const errorText = await response.text();
                    addLog(`âŒ Ø®Ø·Ø£ Ù…Ù† GitHub: ${errorText}`, 'error');
                    return false;
                }
                
            } catch (error) {
                addLog(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©: ${error.message}`, 'error');
                return false;
            }
        }
        
        document.getElementById('uploadForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...';
            
            const formData = {
                channel_link: document.getElementById('channelLink').value.trim(),
                movie_name: document.getElementById('movieName').value.trim(),
                poster_url: document.getElementById('posterUrl').value.trim(),
                video_url: document.getElementById('videoUrl').value.trim()
            };
            
            // ØªÙØ±ÙŠØº Ø§Ù„Ø³Ø¬Ù„Ø§Øª
            document.getElementById('logContainer').innerHTML = '';
            
            addLog('ğŸ¬ Ø¨Ø¯Ø¡ Ø±ÙØ¹ Ø§Ù„ÙÙŠÙ„Ù…...', 'info');
            addLog(`ğŸ“ Ø§Ù„Ø§Ø³Ù…: ${formData.movie_name}`, 'info');
            addLog(`ğŸ“¢ Ø§Ù„Ù‚Ù†Ø§Ø©: ${formData.channel_link}`, 'info');
            addLog('ğŸ“¸ Ø§Ù„ØµÙˆØ±Ø© Ø³ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±', 'info');
            addLog('ğŸ¥ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø³ÙŠØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†', 'info');
            
            // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù€ GitHub Action
            const success = await triggerGitHubAction(formData);
            
            if (!success) {
                addLog('âš ï¸ Ø§ÙØªØ­ ØµÙØ­Ø© Actions ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Run workflow', 'info');
                window.open('https://github.com/elqiser00/Server/actions/workflows/upload_movie.yml', '_blank');
            }
            
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-film"></i> Ø±ÙØ¹ ÙÙŠÙ„Ù… Ø¬Ø¯ÙŠØ¯';
        });
        
        // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
        document.getElementById('videoUrl').addEventListener('blur', function() {
            const url = this.value;
            if (url && !url.includes('.mp4')) {
                addLog('âš ï¸ ØªØ£ÙƒØ¯ Ø£Ù† Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ .mp4', 'error');
            }
        });
        
        // Ù…Ø«Ø§Ù„ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        document.getElementById('posterUrl').addEventListener('blur', function() {
            const img = document.querySelector('.layout-preview img');
            if (this.value) {
                img.src = this.value;
            }
        });
    </script>
</body>
</html>
