name: Upload Media to Telegram

on:
  workflow_dispatch:
    inputs:
      channel_url:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… (Ù…Ø«Ø§Ù„: @channel_name Ø£Ùˆ https://t.me/channel_name Ø£Ùˆ +xxxxxxxxxx)'
        required: true
        type: string
      media_type:
        description: 'Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø±ÙØ¹Ù‡'
        required: true
        default: 'Ø£ÙÙ„Ø§Ù…'
        type: choice
        options:
          - Ø£ÙÙ„Ø§Ù…
          - Ù…Ø³Ù„Ø³Ù„Ø§Øª
      logo_url:
        description: 'Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø´Ø¹Ø§Ø± (Ù„ÙˆØºÙˆ) - Ø§Ø®ØªÙŠØ§Ø±ÙŠ'
        required: false
        type: string
      video_paths:
        description: 'Ø±ÙˆØ§Ø¨Ø· Ø£Ùˆ Ù…Ø³Ø§Ø±Ø§Øª Ù…Ù„ÙØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„) - Ù…Ø«Ø§Ù„: https://example.com/video1.mp4,https://example.com/video2.mp4'
        required: true
        type: string
      caption:
        description: 'Ø§Ù„Ù†Øµ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ (Ø§Ù„ÙƒØ¨Ø´Ø±) - Ø§Ø®ØªÙŠØ§Ø±ÙŠ'
        required: false
        type: string

jobs:
  upload:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
      uses: actions/checkout@v3
      
    - name: ğŸ Ø¥Ø¹Ø¯Ø§Ø¯ Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
      run: |
        python -m pip install --upgrade pip
        pip install telethon==1.34.0
        pip install aiohttp==3.9.1
        
    - name: ğŸš€ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
      env:
        TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
        TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
        TELEGRAM_PHONE: ${{ secrets.TELEGRAM_PHONE }}
        TELEGRAM_PASSWORD: ${{ secrets.TELEGRAM_PASSWORD }}
        TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
        # ØªÙ…Ø±ÙŠØ± Ù…Ø¯Ø®Ù„Ø§Øª workflow
        INPUT_CHANNEL_URL: ${{ inputs.channel_url }}
        INPUT_MEDIA_TYPE: ${{ inputs.media_type }}
        INPUT_LOGO_URL: ${{ inputs.logo_url }}
        INPUT_VIDEO_PATHS: ${{ inputs.video_paths }}
        INPUT_CAPTION: ${{ inputs.caption }}
      run: |
        echo "ğŸ¬ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±ÙØ¹..."
        echo "=" * 40
        echo "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰: ${{ inputs.media_type }}"
        echo "Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø©: ${{ inputs.channel_url }}"
        echo "Ø¹Ø¯Ø¯ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·: $(echo '${{ inputs.video_paths }}' | tr ',' '\n' | wc -l)"
        echo "=" * 40
        python upload_media.py
        
    - name: ğŸ“Š Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø±ÙØ¹
      if: always()
      run: |
        echo "=" * 40
        if [ "${{ job.status }}" = "success" ]; then
          echo "âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ù†Ø¬Ø§Ø­!"
        else
          echo "âŒ ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª"
          echo "ğŸ” ØªØ­Ù‚Ù‚ Ù…Ù†:"
          echo "  1. ØµØ­Ø© Ø§Ù„Ø£Ø³Ø±Ø§Ø± ÙÙŠ GitHub Secrets"
          echo "  2. ØµØ­Ø© Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø©"
          echo "  3. Ø£Ù† Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù†Ø´Ø·Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„"
          echo "  4. Ø£Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ÙØ¹Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…"
        fi
        echo "=" * 40
