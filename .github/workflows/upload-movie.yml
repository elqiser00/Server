name: ðŸŽ¬ Ø±ÙØ¹ ÙÙŠÙ„Ù… - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ

on:
  workflow_dispatch:
    inputs:
      channel_link:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø©'
        required: true
        type: string
      movie_name:
        description: 'Ø§Ø³Ù… Ø§Ù„ÙÙŠÙ„Ù…'
        required: true
        type: string
      poster_url:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨ÙˆØ³ØªØ±'
        required: true
        type: string
      video_url:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± mp4'
        required: true
        type: string

jobs:
  upload:
    runs-on: ubuntu-latest
    timeout-minutes: 30

    steps:
    - name: ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
      run: |
        sudo apt update
        sudo apt install -y python3 python3-pip curl wget ffmpeg
        curl --version
        wget --version

    - name: ØªØ«Ø¨ÙŠØª Ù…ÙƒØªØ¨Ø§Øª Python
      run: |
        pip3 install telethon

    - name: Ø¥Ù†Ø´Ø§Ø¡ Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø±ÙØ¹
      run: |
        cat > upload.py << 'EOF'
        # Ù„ØµÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¹Ù„Ø§Ù‡ Ù‡Ù†Ø§
        EOF

    - name: Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
      run: |
        echo "ðŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª..."
        curl --insecure -I https://google.com
        echo "âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙŠØ¹Ù…Ù„"

    - name: ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø±ÙØ¹
      env:
        TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
        TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
        TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
        CHANNEL_LINK: ${{ github.event.inputs.channel_link }}
        MOVIE_NAME: ${{ github.event.inputs.movie_name }}
        POSTER_URL: ${{ github.event.inputs.poster_url }}
        VIDEO_URL: ${{ github.event.inputs.video_url }}
      run: |
        echo "ðŸ”§ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±ÙØ¹:"
        echo "ðŸŽ¬ Ø§Ù„ÙÙŠÙ„Ù…: $MOVIE_NAME"
        echo "ðŸ“¢ Ø§Ù„Ù‚Ù†Ø§Ø©: $CHANNEL_LINK"
        echo "ðŸ–¼ï¸ Ø¨ÙˆØ³ØªØ±: $POSTER_URL"
        echo "ðŸŽ¥ ÙÙŠØ¯ÙŠÙˆ: $VIDEO_URL"
        echo ""
        python3 upload.py

    - name: Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
      if: always()
      run: |
        echo "ðŸ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªÙ†ÙÙŠØ°"
        echo "ðŸ“‹ Ø§Ø·Ù„Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„ØªÙØ§ØµÙŠÙ„"
