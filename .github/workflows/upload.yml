name: ğŸ“¤ Ø±ÙØ¹ Ù…Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ

on:
  workflow_dispatch:
    inputs:
      mode:
        description: 'Ø§Ù„ÙˆØ¶Ø¹ (Ø§Ø®ØªØ±: movie Ù„Ù„Ø£ÙÙ„Ø§Ù… / series Ù„Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª)'
        required: true
        default: 'movie'
        type: choice
        options:
          - movie
          - series
      
      channel:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø©: @yourchannel Ø£Ùˆ Ø±Ø§Ø¨Ø· Ø¯Ø¹ÙˆØ© (Ù…Ø«Ù„ +Abc123)'
        required: true
        type: string
      
      caption:
        description: 'Ø§Ù„ÙƒØ§Ø¨Ø´Ù†/Ø§Ù„ÙˆØµÙ (Ø§Ø³ØªØ®Ø¯Ù… \n Ù„Ù„ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø·Ø±)'
        required: true
        type: string
      
      image_url:
        description: 'Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ØµÙˆØ±Ø© (Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_url:
        description: 'Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ (Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_name:
        description: 'Ø§Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¨Ø¯ÙˆÙ† .mp4)'
        required: false
        default: 'movie'
        type: string

jobs:
  upload:
    runs-on: ubuntu-latest
    timeout-minutes: 90
    
    steps:
      - name: ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø©
        uses: actions/checkout@v4
        
      - name: ğŸ ØªØ«Ø¨ÙŠØª Ø¨Ø§ÙŠØ«ÙˆÙ† 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: ğŸ¬ ØªØ«Ø¨ÙŠØª FFmpeg
        run: |
          sudo apt-get update -qq
          sudo apt-get install -y ffmpeg
          echo "âœ… FFmpeg Ø¬Ø§Ù‡Ø²"
      
      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
        run: |
          pip install --upgrade pip
          pip install telethon requests urllib3 pillow
      
      - name: ğŸ”’ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø± ÙˆØ§Ù„Ù…Ù„ÙØ§Øª
        run: |
          # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø±
          if [ -z "${{ secrets.TELEGRAM_API_ID }}" ] || [ -z "${{ secrets.TELEGRAM_API_HASH }}" ] || [ -z "${{ secrets.TELEGRAM_SESSION_STRING }}" ]; then
            echo "âŒ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©"
            exit 1
          fi
          
          # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù upload.py
          if [ ! -f "upload.py" ]; then
            echo "âŒ Ù…Ù„Ù upload.py ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø±ÙŠØ¨Ùˆ!"
            echo "ğŸ“ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©:"
            ls -la
            exit 1
          fi
          
          echo "âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­Ù‚Ù‚ÙŠØ§Øª Ù†Ø§Ø¬Ø­Ø©"
      
      - name: ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª
        env:
          MODE: ${{ github.event.inputs.mode }}
          CHANNEL: ${{ github.event.inputs.channel }}
          CAPTION: ${{ github.event.inputs.caption }}
          IMAGE_URL: ${{ github.event.inputs.image_url }}
          VIDEO_URL: ${{ github.event.inputs.video_url }}
          VIDEO_NAME: ${{ github.event.inputs.video_name }}
          TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
          TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
        run: |
          echo "ğŸš€ Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª..."
          python upload.py
      
      - name: âœ… Ù†Ø¬Ø§Ø­
        if: success()
        run: |
          echo "=========================================="
          echo "ğŸ‰ ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!"
          echo "=========================================="
      
      - name: âŒ ÙØ´Ù„
        if: failure()
        run: |
          echo "=========================================="
          echo "ğŸ’¥ ÙØ´Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©!"
          echo "=========================================="
