name: ğŸ“¤ Ø±ÙØ¹ Ù…Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù†)

on:
  workflow_dispatch:
    inputs:
      mode:
        description: 'Ø§Ù„ÙˆØ¶Ø¹ (Ø§Ø®ØªØ±: movie Ù„Ù„Ø£ÙÙ„Ø§Ù… / series Ù„Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª)'
        required: true
        default: 'movie'
        type: choice
        options:
          - movie
          - series
      
      channel:
        description: 'Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø©: @yourchannel Ø£Ùˆ Ø±Ø§Ø¨Ø· Ø¯Ø¹ÙˆØ© (Ù…Ø«Ù„ +Abc123) - ÙŠØ¯Ø¹Ù… ÙƒÙ„ÙŠÙ‡Ù…Ø§!'
        required: true
        type: string
      
      caption:
        description: 'Ø§Ù„ÙƒØ§Ø¨Ø´Ù†/Ø§Ù„ÙˆØµÙ (Ø§Ø³ØªØ®Ø¯Ù… \\n Ù„Ù„ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø·Ø±)'
        required: true
        type: string
      
      image_url:
        description: 'Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ØµÙˆØ±Ø© (Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·) - Ø³ÙŠØªÙ… ØªØ³Ù…ÙŠØªÙ‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Logo.Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯'
        required: false
        type: string
      
      video_url:
        description: 'Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ (Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_name:
        description: 'Ø§Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¨Ø¯ÙˆÙ† .mp4 - Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)'
        required: false
        default: 'movie'
        type: string
      
      series_videos:
        description: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø¨ØµÙŠØºØ© JSON Ø­ØªÙ‰ 10 Ù…Ù„ÙØ§Øª. Ù…Ø«Ø§Ù„: [{"url":"Ø±Ø§Ø¨Ø·1","name":"Ø§Ù„Ø­Ù„Ù‚Ø©1"},{"url":"Ø±Ø§Ø¨Ø·2","name":"Ø§Ù„Ø­Ù„Ù‚Ø©2"}]'
        required: false
        type: string
      
      skip_ssl:
        description: 'ØªØ®Ø·ÙŠ ØªØ­Ù‚Ù‚ SSL (Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹ ØºÙŠØ± Ø§Ù„Ø¢Ù…Ù†Ø© ÙÙ‚Ø·)'
        required: false
        default: 'false'
        type: boolean

jobs:
  upload:
    runs-on: ubuntu-latest
    timeout-minutes: 90
    
    steps:
      - name: ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø©
        uses: actions/checkout@v4
        
      - name: âš¡ ØªØ«Ø¨ÙŠØª ffmpeg (Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ)
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg
          ffmpeg -version
        
      - name: ğŸ ØªØ«Ø¨ÙŠØª Ø¨Ø§ÙŠØ«ÙˆÙ† 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
        run: |
          pip install --upgrade pip setuptools
          pip install telethon requests "pysocks>=1.6.8" "cryptography>=3.0"
      
      - name: ğŸ”’ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø±
        env:
          TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
          TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
        run: |
          if [ -z "$TELEGRAM_API_ID" ] || [ -z "$TELEGRAM_API_HASH" ] || [ -z "$TELEGRAM_SESSION_STRING" ]; then
            echo "âŒ Ø®Ø·Ø£: Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©!"
            echo "ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø³Ø±Ø§Ø± ÙÙŠ Settings â†’ Secrets â†’ Actions:"
            echo "  â€¢ TELEGRAM_API_ID"
            echo "  â€¢ TELEGRAM_API_HASH"
            echo "  â€¢ TELEGRAM_SESSION_STRING"
            exit 1
          fi
          echo "âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­"
      
      - name: ğŸš€ ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø±ÙØ¹
        env:
          MODE: ${{ github.event.inputs.mode }}
          CHANNEL: ${{ github.event.inputs.channel }}
          CAPTION: ${{ github.event.inputs.caption }}
          IMAGE_URL: ${{ github.event.inputs.image_url }}
          VIDEO_URL: ${{ github.event.inputs.video_url }}
          VIDEO_NAME: ${{ github.event.inputs.video_name }}
          SERIES_VIDEOS: ${{ github.event.inputs.series_videos }}
          SKIP_SSL_VERIFY: ${{ github.event.inputs.skip_ssl }}
          TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
          TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
          REPO_TOKEN: ${{ secrets.REPO_TOKEN }}
        run: |
          python upload.py || exit 1
      
      - name: âœ… Ø§ÙƒØªÙ…Ø§Ù„ Ù†Ø§Ø¬Ø­
        if: success()
        run: |
          echo "=========================================="
          echo "ğŸ‰ ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!"
          echo "Ø§Ù„ÙˆØ¶Ø¹: ${{ github.event.inputs.mode }}"
          echo "Ø§Ù„Ù‚Ù†Ø§Ø©: ${{ github.event.inputs.channel }}"
          echo "=========================================="
      
      - name: âŒ ÙØ´Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        if: failure()
        run: |
          echo "=========================================="
          echo "âŒ ÙØ´Ù„Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±ÙØ¹"
          echo "Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£"
          echo "=========================================="
