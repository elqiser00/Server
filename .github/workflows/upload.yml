name: ğŸ“¤ Ø±ÙØ¹ Ù…Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…

on:
  workflow_dispatch:
    inputs:
      mode:
        description: 'Ø§Ù„ÙˆØ¶Ø¹ (movie/series)'
        required: true
        default: 'movie'
        type: choice
        options:
          - movie
          - series
      
      channel:
        description: 'Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© (@channel Ø£Ùˆ ID Ø±Ù‚Ù…ÙŠ)'
        required: true
        type: string
      
      caption:
        description: 'Ø§Ù„ÙƒØ§Ø¨Ø´Ù†/Ø§Ù„ÙˆØµÙ Ù„Ù„Ø¨ÙˆØ³Øª'
        required: true
        type: string
      
      # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù…
      image_url:
        description: 'Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ØµÙˆØ±Ø© (Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_url:
        description: 'Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ (Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_name:
        description: 'Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¨Ø¯ÙˆÙ† Ø§Ù…ØªØ¯Ø§Ø¯ØŒ Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        default: 'movie'
        type: string
      
      # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª
      series_videos:
        description: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø¨ØµÙŠØºØ© JSON (Ø­ØªÙ‰ 10 Ù…Ù„ÙØ§Øª). Ù…Ø«Ø§Ù„: [{"url":"Ø±Ø§Ø¨Ø·1","name":"Ø§Ù„Ø­Ù„Ù‚Ø©1"},{"url":"Ø±Ø§Ø¨Ø·2","name":"Ø§Ù„Ø­Ù„Ù‚Ø©2"}]'
        required: false
        type: string
      
      skip_ssl:
        description: 'ØªØ®Ø·ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† SSL (Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹ ØºÙŠØ± Ø§Ù„Ø¢Ù…Ù†Ø©)'
        required: false
        default: 'false'
        type: boolean

jobs:
  upload:
    runs-on: ubuntu-latest
    timeout-minutes: 60
    
    steps:
      - name: ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø©
        uses: actions/checkout@v4
        
      - name: ğŸ ØªØ«Ø¨ÙŠØª Ø¨Ø§ÙŠØ«ÙˆÙ†
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
        run: |
          pip install --upgrade pip
          pip install telethon requests "pysocks>=1.6.8"
      
      - name: ğŸ”’ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ©
        env:
          TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
          TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
          REPO_TOKEN: ${{ secrets.REPO_TOKEN }}
        run: |
          if [ -z "$TELEGRAM_API_ID" ] || [ -z "$TELEGRAM_API_HASH" ] || [ -z "$TELEGRAM_SESSION_STRING" ]; then
            echo "âŒ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©! ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯:"
            echo "   - TELEGRAM_API_ID"
            echo "   - TELEGRAM_API_HASH"
            echo "   - TELEGRAM_SESSION_STRING"
            exit 1
          fi
          echo "âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­"
      
      - name: ğŸš€ ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø±ÙØ¹
        env:
          MODE: ${{ github.event.inputs.mode }}
          CHANNEL: ${{ github.event.inputs.channel }}
          CAPTION: ${{ github.event.inputs.caption }}
          IMAGE_URL: ${{ github.event.inputs.image_url }}
          VIDEO_URL: ${{ github.event.inputs.video_url }}
          VIDEO_NAME: ${{ github.event.inputs.video_name }}
          SERIES_VIDEOS: ${{ github.event.inputs.series_videos }}
          SKIP_SSL_VERIFY: ${{ github.event.inputs.skip_ssl }}
          TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
          TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
          REPO_TOKEN: ${{ secrets.REPO_TOKEN }}
        run: |
          python upload.py
          
      - name: âœ… Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­
        if: success()
        run: |
          echo "=========================================="
          echo "ğŸ‰ ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!"
          echo "Ø§Ù„ÙˆØ¶Ø¹: ${{ github.event.inputs.mode }}"
          echo "Ø§Ù„Ù‚Ù†Ø§Ø©: ${{ github.event.inputs.channel }}"
          echo "=========================================="
      
      - name: âŒ ÙØ´Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        if: failure()
        run: |
          echo "=========================================="
          echo "âŒ ÙØ´Ù„Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±ÙØ¹ - Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø£Ø¹Ù„Ø§Ù‡"
          echo "=========================================="
