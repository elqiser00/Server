name: ğŸ“¤ Ø±ÙØ¹ Ù…Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… - Ø¥ØµØ¯Ø§Ø± Ù…Ø­Ø³Ù†

on:
  workflow_dispatch:
    inputs:
      mode:
        description: 'Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰'
        required: true
        default: 'movie'
        type: choice
        options:
          - movie
          - series
      
      channel:
        description: 'Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© (@channelname Ø£Ùˆ -100xxx Ø£Ùˆ Ø±Ø§Ø¨Ø·)'
        required: true
        type: string
      
      caption:
        description: 'Ø§Ù„ÙˆØµÙ/Ø§Ù„ÙƒØ§Ø¨Ø´Ù† (Ø§Ø³ØªØ®Ø¯Ù… \n Ù„Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯)'
        required: true
        type: string
      
      # Ø­Ù‚ÙˆÙ„ Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø£ÙÙ„Ø§Ù…
      image_url:
        description: 'Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¨ÙˆØ³ØªØ± (Ù„Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_url:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ù„Ù„Ø£ÙÙ„Ø§Ù… ÙÙ‚Ø·)'
        required: false
        type: string
      
      video_name:
        description: 'Ø§Ø³Ù… Ø§Ù„ÙÙŠÙ„Ù… (Ø¨Ø¯ÙˆÙ† Ø§Ù…ØªØ¯Ø§Ø¯)'
        required: false
        default: 'movie'
        type: string
      
      # Ø­Ù‚Ù„ Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª (JSON)
      series_data:
        description: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ù„Ø³Ù„ (JSON) - Ù„Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª ÙÙ‚Ø·. Ù…Ø«Ø§Ù„: [{"url":"Ø±Ø§Ø¨Ø·1","name":"Ø­1"},{"url":"Ø±Ø§Ø¨Ø·2","name":"Ø­2"}]'
        required: false
        type: string

jobs:
  upload:
    runs-on: ubuntu-latest
    timeout-minutes: 120  # Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
    
    steps:
      - name: ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø©
        uses: actions/checkout@v4
        
      - name: ğŸ ØªØ«Ø¨ÙŠØª Ø¨Ø§ÙŠØ«ÙˆÙ† 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: ğŸ¬ ØªØ«Ø¨ÙŠØª FFmpeg
        run: |
          sudo apt-get update -qq
          sudo apt-get install -y ffmpeg
          echo "âœ… FFmpeg Ø¬Ø§Ù‡Ø²"
          ffmpeg -version | head -1
      
      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
        run: |
          pip install --upgrade pip
          pip install telethon requests pillow
      
      - name: ğŸ”’ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø±
        env:
          API_ID: ${{ secrets.TELEGRAM_API_ID }}
          API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          SESSION: ${{ secrets.TELEGRAM_SESSION_STRING }}
        run: |
          if [ -z "$API_ID" ] || [ -z "$API_HASH" ] || [ -z "$SESSION" ]; then
            echo "âŒ Ø®Ø·Ø£: Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© Ù…ÙÙ‚ÙˆØ¯Ø©!"
            echo "Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: TELEGRAM_API_ID, TELEGRAM_API_HASH, TELEGRAM_SESSION_STRING"
            exit 1
          fi
          echo "âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø±Ø§Ø± Ù…ÙˆØ¬ÙˆØ¯Ø©"
      
      - name: ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª
        env:
          MODE: ${{ github.event.inputs.mode }}
          CHANNEL: ${{ github.event.inputs.channel }}
          CAPTION: ${{ github.event.inputs.caption }}
          IMAGE_URL: ${{ github.event.inputs.image_url }}
          VIDEO_URL: ${{ github.event.inputs.video_url }}
          VIDEO_NAME: ${{ github.event.inputs.video_name }}
          SERIES_DATA: ${{ github.event.inputs.series_data }}
          TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
          TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
          TELEGRAM_SESSION_STRING: ${{ secrets.TELEGRAM_SESSION_STRING }}
        run: |
          python upload.py
      
      - name: âœ… Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        if: success()
        run: |
          echo "ğŸ‰ ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!"
      
      - name: âŒ ÙØ´Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        if: failure()
        run: |
          echo "ğŸ’¥ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹ØŒ Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø£Ø¹Ù„Ø§Ù‡"
